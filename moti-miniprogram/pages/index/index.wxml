<!-- 最新页面 - 问题列表 -->
<view class="page {{darkMode ? 'dark' : ''}}">
  <view class="container" style="padding-top: {{statusBarHeight}}px;">

    <!-- 顶部导航栏 -->
    <view class="nav-header">
      <view class="nav-left">
        <view class="back-btn" bindtap="handleBack" wx:if="{{canGoBack}}">
          <image src="/images/icons/arrow-left.svg" class="back-icon" mode="aspectFit" />
        </view>
      </view>
      <view class="nav-center">
        <text class="nav-title">莫提之地</text>
      </view>
      <view class="nav-right">
        <view class="nav-capsule">
          <view class="capsule-dots">
            <view class="dot"></view>
            <view class="dot dot-large"></view>
            <view class="dot"></view>
          </view>
          <view class="capsule-divider"></view>
          <view class="capsule-icon">
            <image src="/images/icons/scan.svg" class="icon-img" mode="aspectFit" />
          </view>
        </view>
      </view>
    </view>

    <!-- 搜索栏 -->
    <view class="search-bar">
      <view class="search-input-wrapper" bindtap="goToSearch">
        <image src="/images/icons/search.svg" class="search-icon" mode="aspectFit" />
        <text class="search-placeholder">搜索...</text>
      </view>
      <view class="message-btn" bindtap="goToMessages">
        <image src="/images/icons/message.svg" class="message-icon" mode="aspectFit" />
        <view class="badge" wx:if="{{unreadCount > 0}}">
          <text>{{unreadCount > 99 ? '99+' : unreadCount}}</text>
        </view>
      </view>
    </view>

    <!-- Tab 标签 -->
    <view class="tab-header">
      <view
        class="tab-item {{activeTab === 'latest' ? 'active' : ''}}"
        bindtap="switchTab"
        data-tab="latest"
      >
        <text>最新</text>
        <view class="tab-line" wx:if="{{activeTab === 'latest'}}"></view>
      </view>
      <view
        class="tab-item {{activeTab === 'hot' ? 'active' : ''}}"
        bindtap="switchTab"
        data-tab="hot"
      >
        <text>最热</text>
        <view class="tab-line" wx:if="{{activeTab === 'hot'}}"></view>
      </view>
      <view
        class="tab-item {{activeTab === 'random' ? 'active' : ''}}"
        bindtap="switchTab"
        data-tab="random"
      >
        <text>随缘</text>
        <view class="tab-line" wx:if="{{activeTab === 'random'}}"></view>
      </view>
    </view>

    <!-- 问题列表 -->
    <scroll-view
      class="question-list"
      scroll-y
      enhanced
      show-scrollbar="{{false}}"
      refresher-enabled
      refresher-triggered="{{refreshing}}"
      bindrefresherrefresh="onRefresh"
      bindscrolltolower="loadMore"
    >
      <view class="question-list-inner">
        <view
          class="question-item"
          wx:for="{{questions}}"
          wx:key="id"
          bindtap="openQuestion"
          data-id="{{item.id}}"
        >
          <text class="question-text">{{item.title}}</text>
          <view class="hot-tag" wx:if="{{item.isHot}}">
            <text>热</text>
          </view>
        </view>
      </view>

      <!-- 加载状态 -->
      <view class="loading-wrapper" wx:if="{{loading}}">
        <view class="loading-spinner"></view>
        <text class="loading-text">加载中...</text>
      </view>

      <!-- 空状态 -->
      <view class="empty-wrapper" wx:if="{{!loading && questions.length === 0}}">
        <image src="/images/icons/empty.svg" class="empty-icon" mode="aspectFit" />
        <text class="empty-text">暂无问题</text>
      </view>

      <!-- 没有更多 -->
      <view class="no-more" wx:if="{{!hasMore && questions.length > 0}}">
        <text>— 已经到底啦 —</text>
      </view>

      <!-- 底部安全区域 -->
      <view class="safe-bottom"></view>
    </scroll-view>

    <!-- 底部 TabBar -->
    <view class="bottom-tab-bar">
      <view class="bottom-tab-item active">
        <image src="/images/icons/tab-home-active.svg" class="bottom-tab-icon" mode="aspectFit" />
        <text class="bottom-tab-text">最新</text>
      </view>
      <view class="bottom-tab-item" bindtap="goToTopics">
        <image src="/images/icons/tab-topics.svg" class="bottom-tab-icon" mode="aspectFit" />
        <text class="bottom-tab-text">合集</text>
      </view>
      <view class="bottom-tab-item" bindtap="goToAsk">
        <image src="/images/icons/tab-ask.svg" class="bottom-tab-icon" mode="aspectFit" />
        <text class="bottom-tab-text">提问</text>
      </view>
      <view class="bottom-tab-item" bindtap="goToProfile">
        <image src="/images/icons/tab-profile.svg" class="bottom-tab-icon" mode="aspectFit" />
        <text class="bottom-tab-text">我的</text>
      </view>
    </view>

  </view>
</view>
