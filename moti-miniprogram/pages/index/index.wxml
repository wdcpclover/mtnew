<!-- 最新页面 - 1:1 还原 -->
<view class="page {{darkMode ? 'dark' : ''}}">
  <view class="container">

    <!-- 顶部导航栏 (灰色背景) -->
    <view class="nav-header" style="padding-top: {{statusBarHeight}}px; height: {{navBarHeight}}px;">
      <view class="nav-left">
        <!-- Back button logic here if needed, usually hidden on index -->
      </view>
      <view class="nav-center">
        <text class="nav-title">莫提之地</text>
      </view>
      <view class="nav-right">
        <!-- Capsule placeholder if needed for spacing -->
      </view>
    </view>

    <!-- 搜索栏区域 (白色圆角块) -->
    <view class="search-section">
      <view class="search-input-wrapper" bindtap="goToSearch">
        <image src="/images/icons/search-bar-icon{{darkMode ? '-dark' : ''}}.svg" class="search-icon" mode="aspectFit" />
        <text class="search-placeholder">搜索...</text>
      </view>
      <view class="message-btn" bindtap="goToMessages">
        <image src="/images/icons/message-bar-icon{{darkMode ? '-dark' : ''}}.svg" class="message-icon" mode="aspectFit" />
        <view class="badge" wx:if="{{unreadCount > 0}}">
          <text>{{unreadCount > 99 ? '99+' : unreadCount}}</text>
        </view>
      </view>
    </view>

    <!-- 内容区域 (白色大圆角卡片) -->
    <view class="content-container">
      <!-- Tab 标签 -->
      <view class="tab-header">
        <view
          class="tab-item {{activeTab === 'latest' ? 'active' : ''}}"
          bindtap="switchTab"
          data-tab="latest"
        >
          <text>最新</text>
          <view class="tab-line" wx:if="{{activeTab === 'latest'}}"></view>
        </view>
        <view
          class="tab-item {{activeTab === 'hot' ? 'active' : ''}}"
          bindtap="switchTab"
          data-tab="hot"
        >
          <text>最热</text>
          <view class="tab-line" wx:if="{{activeTab === 'hot'}}"></view>
        </view>
        <view
          class="tab-item {{activeTab === 'random' ? 'active' : ''}}"
          bindtap="switchTab"
          data-tab="random"
        >
          <text>随缘</text>
          <view class="tab-line" wx:if="{{activeTab === 'random'}}"></view>
        </view>
      </view>

      <!-- 问题列表 -->
      <scroll-view
        class="question-list"
        scroll-y
        enhanced
        show-scrollbar="{{true}}"
        refresher-enabled
        refresher-triggered="{{refreshing}}"
        bindrefresherrefresh="onRefresh"
        bindscrolltolower="loadMore"
      >
        <view class="question-list-inner">
          <view
            class="question-item"
            wx:for="{{questions}}"
            wx:key="id"
            bindtap="openQuestion"
            data-id="{{item.id}}"
          >
            <text class="question-text">{{item.title}}</text>
            <view class="hot-tag" wx:if="{{item.isHot}}">
              <text class="hot-text">热</text>
            </view>
          </view>
        </view>

        <!-- 加载状态 -->
        <view class="loading-wrapper" wx:if="{{loading}}">
          <view class="loading-spinner"></view>
        </view>

        <!-- 空状态 -->
        <view class="empty-wrapper" wx:if="{{!loading && questions.length === 0}}">
          <image src="/images/icons/empty.svg" class="empty-icon" mode="aspectFit" />
          <text class="empty-text">暂无问题</text>
        </view>

        <!-- 底部占位 -->
        <view style="height: 40rpx;"></view>
      </scroll-view>
    </view>

    <!-- 底部 TabBar (复用组件) -->
    <tab-bar current="{{0}}" />

  </view>
</view>
